"use strict";(self["webpackChunkvue_crm"]=self["webpackChunkvue_crm"]||[]).push([[938],{2938:function(e,t,i){i.r(t),i.d(t,{default:function(){return A}});var a=i(3396),l=i(7139);const n={class:"page-title"},s={key:1,class:"row"},r={key:1,class:"center"};function o(e,t,i,o,u,d){const c=(0,a.up)("Loader"),m=(0,a.up)("CategoryCreate"),p=(0,a.up)("CategoryEdit");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",n,[(0,a._)("h3",null,(0,l.zw)(e.$localize("Categories")),1)]),(0,a._)("section",null,[e.loading?((0,a.wg)(),(0,a.j4)(c,{key:0})):((0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(m,{onCreated:d.addNewCategory},null,8,["onCreated"]),e.categories.length?((0,a.wg)(),(0,a.j4)(p,{options:e.categories,key:e.categories.length+e.updateCount,onUpdated:d.updateCategories},null,8,["options","onUpdated"])):((0,a.wg)(),(0,a.iD)("p",r,(0,l.zw)(e.$localize("Cat_Message")),1))]))])])}var u=i(9242);const d={class:"col s12 m6"},c={class:"page-subtitle"},m={class:"input-field"},p={for:"name"},h={class:"input-field"},v={for:"limit"},$={class:"btn waves-effect waves-light",type:"submit"},g=(0,a._)("i",{class:"material-icons right"},"send",-1);function w(e,t,i,n,s,r){return(0,a.wg)(),(0,a.iD)("div",d,[(0,a._)("div",null,[(0,a._)("div",c,[(0,a._)("h4",null,(0,l.zw)(e.$localize("Create")),1)]),(0,a._)("form",{onSubmit:t[2]||(t[2]=(0,u.iM)(((...e)=>r.onSubmit&&r.onSubmit(...e)),["prevent"]))},[(0,a._)("div",m,[(0,a.wy)((0,a._)("input",{id:"name",type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.name=t),class:(0,l.C_)({invalid:n.v$.name.$error})},null,2),[[u.nr,e.name]]),(0,a._)("label",p,(0,l.zw)(e.$localize("Cat_Title")),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.v$.name.$errors,(t=>((0,a.wg)(),(0,a.iD)("span",{class:"helper-text invalid",key:t.$uid},(0,l.zw)(e.$localize("Cat_EnterTitle")),1)))),128))]),(0,a._)("div",h,[(0,a.wy)((0,a._)("input",{id:"limit",type:"number","onUpdate:modelValue":t[1]||(t[1]=t=>e.limit=t),class:(0,l.C_)({invalid:n.v$.limit.$error})},null,2),[[u.nr,e.limit,void 0,{number:!0}]]),(0,a._)("label",v,(0,l.zw)(e.$localize("Cat_Limit")),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.v$.limit.$errors,(t=>((0,a.wg)(),(0,a.iD)("span",{class:"helper-text invalid",key:t.$uid},(0,l.zw)(`${e.$localize("Cat_Limit")}: ${t.$message}`),1)))),128))]),(0,a._)("button",$,[(0,a.Uk)((0,l.zw)(e.$localize("Create"))+" ",1),g])],32)])])}var _=i(2112),C=i(9117),y=i(5797),f={setup(){return{v$:(0,_.ZP)()}},data:()=>({name:"",limit:1}),validations:{name:{required:C.C1,$autoDirty:!0},limit:{required:C.C1,minValue:(0,C.uv)(1),$autoDirty:!0}},mounted(){(0,y.updateTextFields)()},methods:{async onSubmit(){const e=await this.v$.$validate();if(!e)return;const t={name:this.name,limit:this.limit};try{const e=await this.$store.dispatch("createCategory",t);this.name="",this.limit=1,this.v$.$reset(),this.$message(`Категория ${e.name} успешно создана`),this.$emit("created",e)}catch(i){}}}},z=i(89);const b=(0,z.Z)(f,[["render",w]]);var D=b;const k={class:"col s12 m6"},S={class:"page-subtitle"},x={class:"input-field"},U=["value"],T={class:"input-field"},V={for:"name"},K={class:"input-field"},Z={for:"limit"},q={class:"btn waves-effect waves-light",type:"submit"},E=(0,a._)("i",{class:"material-icons right"},"send",-1);function H(e,t,i,n,s,r){return(0,a.wg)(),(0,a.iD)("div",k,[(0,a._)("div",null,[(0,a._)("div",S,[(0,a._)("h4",null,(0,l.zw)(e.$localize("Cat_Edit")),1)]),(0,a._)("form",{onSubmit:t[3]||(t[3]=(0,u.iM)(((...e)=>r.onSubmit&&r.onSubmit(...e)),["prevent"]))},[(0,a._)("div",x,[(0,a.wy)((0,a._)("select",{ref:"select","onUpdate:modelValue":t[0]||(t[0]=t=>e.current=t)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.options,(e=>((0,a.wg)(),(0,a.iD)("option",{key:e.id,value:e.id},(0,l.zw)(e.name),9,U)))),128))],512),[[u.bM,e.current]]),(0,a._)("label",null,(0,l.zw)(e.$localize("Cat_Choose")),1)]),(0,a._)("div",T,[(0,a.wy)((0,a._)("input",{id:"name",type:"text","onUpdate:modelValue":t[1]||(t[1]=t=>e.name=t),class:(0,l.C_)({invalid:n.v$.name.$error})},null,2),[[u.nr,e.name]]),(0,a._)("label",V,(0,l.zw)(e.$localize("Cat_Title")),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.v$.name.$errors,(t=>((0,a.wg)(),(0,a.iD)("span",{class:"helper-text invalid",key:t.$uid},(0,l.zw)(e.$localize("Cat_EnterTitle")),1)))),128))]),(0,a._)("div",K,[(0,a.wy)((0,a._)("input",{id:"limit",type:"number","onUpdate:modelValue":t[2]||(t[2]=t=>e.limit=t),class:(0,l.C_)({invalid:n.v$.limit.$error})},null,2),[[u.nr,e.limit,void 0,{number:!0}]]),(0,a._)("label",Z,(0,l.zw)(e.$localize("Cat_Limit")),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.v$.limit.$errors,(e=>((0,a.wg)(),(0,a.iD)("span",{class:"helper-text invalid",key:e.$uid},(0,l.zw)(`Лимит: ${e.$message}`),1)))),128))]),(0,a._)("button",q,[(0,a.Uk)((0,l.zw)(e.$localize("Submit"))+" ",1),E])],32)])])}var Y={setup(){return{v$:(0,_.ZP)()}},props:{options:{type:Array,required:!0}},data:()=>({select:null,name:"",limit:1,current:null}),validations:{name:{required:C.C1,$autoDirty:!0},limit:{required:C.C1,minValue:(0,C.uv)(1),$autoDirty:!0}},watch:{current(e){const{name:t,limit:i}=this.options.find((t=>t.id===e));this.name=t,this.limit=i,this.current=e}},created(){const{id:e,name:t,limit:i}=this.options[0];this.name=t,this.limit=i,this.current=e},mounted(){(0,y.updateTextFields)(),this.select=y.FormSelect.init(this.$refs.select)},unmounted(){this.select&&this.select.unmounted&&this.select.unmounted()},methods:{async onSubmit(){const e=await this.v$.$validate();if(!e)return;const t={id:this.current,name:this.name,limit:this.limit};try{await this.$store.dispatch("updateCategory",t),this.$message("Категория успешно изменена"),this.$emit("updated",t)}catch(i){}}}};const F=(0,z.Z)(Y,[["render",H]]);var L=F,M=i(2350),P=i(6316),j={setup(){(0,M.Kf)({title:(0,a.Fl)((()=>(0,P.Z)("ProfileTitle")))})},name:"categories",data:()=>({categories:[],loading:!0,updateCount:0}),components:{CategoryCreate:D,CategoryEdit:L},async mounted(){this.categories=await this.$store.dispatch("fetchCategories"),this.loading=!1},methods:{addNewCategory(e){this.categories.push(e)},updateCategories({id:e,name:t,limit:i}){const a=this.categories.findIndex((t=>t.id===e));this.categories[a].name=t,this.categories[a].limit=i,this.updateCount++}}};const N=(0,z.Z)(j,[["render",o]]);var A=N}}]);
//# sourceMappingURL=938.daa73fdd.js.map